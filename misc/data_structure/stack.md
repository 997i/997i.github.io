# 数据结构快览 - 栈

栈是一种存放对象的容器，在插入和删除元素时，遵循`LIFO`（Last-In-First-Out）原则。栈和队列一样是最常见也是最重要的数据结构。

栈的应用非常广泛：浏览器访问历史的前进后退以及文本编辑器的撤销重做等。

## 栈ADT（抽象数据类型）

- push
- pop
- getSize
- isEmpty
- top

## 复杂度分析

栈的各种操作都是O(1)

## JVM中的栈

**方法栈**

程序执行期间，JVM会维护一个栈，其中的元素是当前活跃的某个方法的描述符，称作`帧`(Frame)。

比如方法N调用了M，那么M在这个帧中，同时这个帧还记录了M的调用参数和局部变量。当然还有关于N的信息以及M的返回值。

JVM还设置了一个`程序计数器`(Program counter)，记录程序在JVM中运行到的当前位置。当N调用M的时候，程序计数器的数值也存放在帧中。栈中最顶层的帧，总是对应于当前正在执行的方法，其余的各个帧对应挂起、尚未执行完的方法。栈底的帧对应main方法，其余的按各自调用顺序排列。每当一个方法被调用，其对应的帧入栈，当方法执行完成以后，程序计数器就会恢复为先前保存的值，然后改帧出栈，将控制权转移给栈顶对应的方法。

Java栈还会将参数传递给被调用的方法，按照值传递（Call by value）的方式。

`递归`的实现也是Java栈的一个典型应用。

**操作数栈**

在对算术表达式求值时JVM使用了操作数栈。
比如执行a + b这样的二元操作时，首先将a和b压栈，然后执行专门指令将这两个元素弹出做加法，并将结果重新压栈。

## 应用实例

**表达式中的括号匹配**

假设我们的表达式允许出现成对匹配的括号（大括号、小括号、方括号），那么我们如何检验这个括号使用是否正确呢？

> 解决方法就是使用栈：遇到左括号压栈，遇到右括号的时候从栈顶出栈与当前右括号匹配即可。

同样使用栈也能够验证`HTML文档标签`匹配是否合理。

## JDK源码学习

在线地址：[java.util.Stack](http://www.docjar.com/html/api/java/util/Stack.java.html)

从源码实现中可得知Java中的Stack继承自`Vector`，且有5个操作方法：

- push
- pop
- peek（获取顶端元素）
- empty
- search

> 注意：在Java中如果需要使用栈，优先使用`Deque`接口及其实现。
因为在LIFO操作的完整性和一致性上表现更好。

比如[java.util.ArrayDeque](http://www.docjar.com/html/api/java/util/ArrayDeque.java.html)

```javascript
Deque<Integer> stack = new ArrayDeque<Integer>();
```
